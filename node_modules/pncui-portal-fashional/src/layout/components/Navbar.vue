<template>
  <div class="navbar">
<!--    <hamburger
      id="hamburger-container"
      :is-active="sidebar.opened"
      class="hamburger-container"
      @toggleClick="toggleSideBar"
    />-->

    <breadcrumb v-if="showBreadcrumb" id="breadcrumb-container" class="breadcrumb-container"/>
    <div class="right-menu">
      <template v-if="device!=='mobile'">
<!--        <el-tooltip content="搜索菜单" effect="dark" placement="bottom">
          <search id="header-search" class="right-menu-item"/>
        </el-tooltip>-->

        <!-- <el-tooltip content="源码地址" effect="dark" placement="bottom">
          <Github class="right-menu-item hover-effect" />
        </el-tooltip> -->

        <el-tooltip content="全屏缩放" effect="dark" placement="bottom">
          <screenfull id="screenfull" class="right-menu-item hover-effect"/>
        </el-tooltip>
        <!--<el-tooltip content="更换主题" effect="dark" placement="bottom">-->
        <theme-select id="theme" class="right-menu-item hover-effect"></theme-select>
        <!--</el-tooltip>-->
        <!-- <el-tooltip content="布局设置" effect="dark" placement="bottom">
          <size-select id="size-select" class="right-menu-item hover-effect" />
        </el-tooltip>-->
        <div class="right-menu-item hover-effect">
<!--          <el-tooltip :content="user.deptId">
            <el-link style="color: #FFFFFF">{{user.dept}}</el-link>
          </el-tooltip>-->
          <el-link style="color: #FFFFFF">{{user.dept}}</el-link>
        </div>
        <role-select id="role-select" class="right-menu-item hover-effect"/>
      </template>
      <el-dropdown class="avatar-container right-menu-item hover-effect" trigger="click">
        <div class="avatar-wrapper">
<!--          <el-tooltip :content="user.username">
            &lt;!&ndash; <img :src="user.avatar ? baseApi + user.avatar : Avatar" class="user-avatar">&ndash;&gt;
            <el-link style="color: #FFFFFF">{{ user.nickName }}</el-link>
          </el-tooltip>-->
          <el-link style="color: #FFFFFF">{{ user.nickName }}</el-link>
          <i class="el-icon-caret-bottom"/>
        </div>
        <el-dropdown-menu slot="dropdown">
          <!-- <a target="_blank" href="https://docs.auauz.net/">
            <el-dropdown-item>
              项目文档
            </el-dropdown-item>
          </a> -->
          <!--  <span style="display:block;" @click="show = true">
            <el-dropdown-item>
              布局设置
            </el-dropdown-item>
          </span>-->
          <router-link to="/user/center">
            <el-dropdown-item>
              个人中心
            </el-dropdown-item>
          </router-link>
          <span style="display:block;" @click="open">
            <el-dropdown-item divided>
              退出登录
            </el-dropdown-item>
          </span>
        </el-dropdown-menu>
      </el-dropdown>
    </div>
  </div>
</template>

<script>
  import { mapGetters, mapState } from 'vuex'
  import Breadcrumb from '@eladmin/components/Breadcrumb'
  import Hamburger from '@eladmin/components/Hamburger'
  // import Github from '@/components/Github'
  import Screenfull from '@eladmin/components/Screenfull'
  import SizeSelect from '@eladmin/components/SizeSelect'
  import Search from '@eladmin/components/HeaderSearch'
  import Avatar from '@eladmin/assets/images/avatar.png'
  import RoleSelect from '@eladmin/components/RoleSelect'
  import ThemeSelect from '../../components/ThemeSelect'

  export default {
    components: {
      Breadcrumb,
      Hamburger,
      Screenfull,
      SizeSelect,
      Search,
      // Github
      RoleSelect,
      ThemeSelect
    },
    data() {
      return {
        Avatar: Avatar,
        dialogVisible: false
      }
    },
    computed: {
      ...mapGetters([
        'sidebar',
        'device',
        'user',
        'baseApi'
      ]),
      ...mapState({
        showBreadcrumb: state => state.settings.showBreadcrumb
      }),
      show: {
        get() {
          return this.$store.state.settings.showSettings
        },
        set(val) {
          this.$store.dispatch('settings/changeSetting', {
            key: 'showSettings',
            value: val
          })
        }
      }
    },
    methods: {
      toggleSideBar() {
        this.$store.dispatch('app/toggleSideBar')
      },
      open() {
        this.$confirm('确定注销并退出系统吗？', '提示', {
          confirmButtonText: '确定',
          cancelButtonText: '取消',
          type: 'warning'
        }).then(() => {
          this.logout()
        })
      },
      logout() {
        this.$store.dispatch('LogOut').then(() => {
          location.reload()
        })
      }
    }
  }
</script>

<style lang="scss" scoped>

</style>
