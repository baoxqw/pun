{"remainingRequest":"D:\\GienProject\\poc\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\GienProject\\poc\\Pncui-Indicator\\src\\views\\indicators\\API\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\GienProject\\poc\\Pncui-Indicator\\src\\views\\indicators\\API\\index.vue","mtime":1646738136330},{"path":"D:\\GienProject\\poc\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\GienProject\\poc\\Pncui-Indicator\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\GienProject\\poc\\Pncui-Indicator\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\GienProject\\poc\\Pncui-Indicator\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n  import indApiInfo,{testInterface} from '../../../api/apiInfo/apiInfo.js'\n  import {getListByApiId} from '../../../api/apiInfo/apiAndAtomRelation.js'\n  import CRUD, { presenter, header, form, crud } from '@crud/crud'\n  import apiAndAtomRelation from './apiAndAtom'\n  import apiAndSystemRelation from './apiAndSystem'\n  import rrOperation from '@crud/RR.operation'\n  import crudOperation from '@crud/CRUD.operation'\n  import udOperation from '@crud/UD.operation'\n  import pagination from '@crud/Pagination'\n  import {getData2Api} from '../../../api/indicators/indIndicatorManual'\n  import { getDepts} from '@/utils/system'\n  import Treeselect from '@riophae/vue-treeselect'\n  import '@riophae/vue-treeselect/dist/vue-treeselect.css'\n  // crud交由presenter持有\n  const defaultCrud = CRUD({ title: 'API管理', url: indApiInfo.url, sort: 'id,desc', crudMethod: { ...indApiInfo.crud }})\n  const defaultForm = {\n    id: null,\n    bizName: [],\n    bizCode: null,\n    currency: null,\n    frequency: null,\n    sysName: null,\n    password: null,\n    url: null,\n    interfaceCode: null,\n    interfaceName: null,\n    remark: null,\n    crtUserCode: null,\n    crtOrgCode: null,\n    crtDate: null,\n    updUserCode: null,\n    updOrgCode: null,\n    updDate: null }\n    const bizNames={}\n    const depts={}\n    const testNames={}\n    const input2 ={}\n  export default {\n    name: 'indApiInfo',\n    components: { apiAndAtomRelation,apiAndSystemRelation,Treeselect,pagination, crudOperation, rrOperation, udOperation },\n    mixins: [presenter(defaultCrud), header(), form(defaultForm), crud()],\n    dicts: ['IND_CURRENCY', 'IE_FREQUENCY'],\n\n    data() {\n      return {\n        apiAndAtomRelation:'apiAndAtomRelation',\n        apiAndSystemRelation:'apiAndSystemRelation',\n        activeName: \"first\",\n        bizNames,\n        testNames,\n        interfaceDialog:false,\n        rolesDialog:false,\n        value: null,\n        testName: '',\n        input1:'',\n        input2,\n        idToChild:'',\n        businessDept:null,\n        depts,\n        permission: {\n          add: ['admin', 'resultCheck:add'],\n          edit: ['admin', 'resultCheck:edit'],\n          del: ['admin', 'resultCheck:del']\n        },\n        rules: {\n          interfaceCode: [\n            { required: true, message: '接口编码不能为空', trigger: 'blur' }\n          ],\n          interfaceName: [\n            { required: true, message: '接口名称不能为空', trigger: 'blur' }\n          ],\n        },\n      }\n    },\n    created() {\n      this.getDepts();\n\n    },\n    mounted() {\n/*      getData2Api().then(data => {\n        this.bizNames = data.data;\n      })*/\n    },\n    methods: {\n      // 获取数据前设置好接口地址\n      [CRUD.HOOK.beforeRefresh]() {\n        this.crud.optShow.del = true\n        this.crud.optShow.add = true\n        this.crud.optShow.edit = true\n        return true\n      },\n      [CRUD.HOOK.beforeSubmit]() {\n        this.form.bizName = this.form.bizName == null? null : Array.isArray(this.form.bizName)? this.form.bizName.join(\",\") : this.form.bizName\n      },\n      [CRUD.HOOK.beforeToEdit](data) {\n        this.form.formType= 'edit';\n        this.form.bizName = this.crud.selections[0].bizName == null? null : Array.isArray(this.crud.selections[0].bizName)? this.crud.selections[0].bizName : this.crud.selections[0].bizName.split(',')\n      },\n      forceUpdate(e){\n        this.$forceUpdate(); //\n      },\n      forRoles(){\n        this.idToChild = this.crud.selections[0].id;\n        this.rolesDialog = true;\n      },\n      closeRolesDialog(){\n        this.rolesDialog = false;\n        this.crud.toQuery();\n      },\n      testInterface(){\n\n        getListByApiId(this.crud.selections[0].id).then(data =>{\n          console.log(data)\n          this.testNames = data.data\n          this.interfaceDialog = true;\n        })\n        console.log( \"------------------\"+this.testNames)\n        console.log( this.depts)\n        console.log(this.crud.selections[0].bizName)\n      },\n      closeDialog(){\n        this.interfaceDialog = false;\n\n      },\n      doSubmit(){\n        this.value;\n        this.businessDept;\n        var name = this.testName;\n        var id = this.crud.selections[0].id;\n        console.log(this.value)\n        var beginTime = null;\n        var endTime = null;\n        if(this.value != null){\n          var beginTime = this.handleDate(this.value[0]);\n          var endTime = this.handleDate(this.value[1]);\n        }\n\n        if(this.businessDept == null || this.businessDept == undefined) this.businessDept =null;\n        if(name ==null||name == undefined ||name ==\"\"){\n          this.$message({\n            message: '请选择一个指标',\n            type: 'warning'\n          });\n        }else {\n          testInterface(id,name,this.businessDept,beginTime,endTime).then(data => {\n            console.log(data)\n            this.input1 = data.code;\n            this.input2 = data.data;\n          })\n        }\n      },\n      handleDate(date){\n        if(date== null ||date ==undefined){\n          return null;\n        }\n        let month = date.getMonth()+1;\n        return date.getFullYear()+\"-\"+month+\"-\"+date.getDate();\n      },\n      getDepts() {\n        getDepts({ enabled: true }).then(res => {\n          this.depts = res.content\n        })\n      },\n\n      handleClick(tab) {\n        if(tab.name == \"first\") {\n          this.apiAndAtomRelation = true;\n          this.apiAndSystemRelation = false;\n        } else if(tab.name == \"second\") {\n          this.apiAndSystemRelation = true;\n          this.apiAndAtomRelation = false;\n        }\n      },\n\n    }\n  }\n",null]}