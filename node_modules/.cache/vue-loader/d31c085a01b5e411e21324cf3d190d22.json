{"remainingRequest":"/Users/xuqianwen/Desktop/computer/农商/poc原项目/poc 2/Pncui-Indicator/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xuqianwen/Desktop/computer/农商/poc原项目/poc 2/Pncui-Indicator/src/views/indicators/statements/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xuqianwen/Desktop/computer/农商/poc原项目/poc 2/Pncui-Indicator/src/views/indicators/statements/index.vue","mtime":1652174136456},{"path":"/Users/xuqianwen/Desktop/computer/农商/poc原项目/poc 2/Pncui-Indicator/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xuqianwen/Desktop/computer/农商/poc原项目/poc 2/Pncui-Indicator/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/xuqianwen/Desktop/computer/农商/poc原项目/poc 2/Pncui-Indicator/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xuqianwen/Desktop/computer/农商/poc原项目/poc 2/Pncui-Indicator/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  name: \"index\",\n  data() {\n    return {\n      data: [\n        {\n          id: 1,\n          label: \"一级 1\",\n          children: [\n            {\n              id: 4,\n              label: \"二级 1-1\",\n              children: [\n                {\n                  id: 9,\n                  label: \"三级 1-1-1\"\n                },\n                {\n                  id: 10,\n                  label: \"三级 1-1-2\"\n                }\n              ]\n            }\n          ]\n        },\n        {\n          id: 2,\n          label: \"一级 2\",\n          children: [\n            {\n              id: 5,\n              label: \"二级 2-1\"\n            },\n            {\n              id: 6,\n              label: \"二级 2-2\"\n            }\n          ]\n        },\n        {\n          id: 3,\n          label: \"一级 3\",\n          children: [\n            {\n              id: 7,\n              label: \"二级 3-1\"\n            },\n            {\n              id: 8,\n              label: \"二级 3-2\",\n              children: [\n                {\n                  id: 11,\n                  label: \"三级 3-2-1\"\n                },\n                {\n                  id: 12,\n                  label: \"三级 3-2-2\"\n                },\n                {\n                  id: 13,\n                  label: \"三级 3-2-3\"\n                }\n              ]\n            }\n          ]\n        }\n      ],\n      isEditHeader: false,\n      isUpdate:true,\n      isEdit: true,\n      propArr:[], // 生成dynamicColumns时的记录\n      dynamicColumns: [], // 存放动态生成列\n      tableData: [\n        {\n          date: \"2016-05-02\",\n          name: \"王小虎1\",\n          address: \"上海市普陀区金沙江路 1518 弄\",\n          isEditor: false,\n          custom: \"\"\n        },\n        {\n          date: \"2016-05-04\",\n          name: \"王小红\",\n          address: \"上海市普陀区金沙江路 1517 弄\",\n          isEditor: false,\n          custom: \"\"\n        },\n        {\n          date: \"2016-05-01\",\n          name: \"王小翠\",\n          address: \"上海市普陀区金沙江路 1519 弄\",\n          isEditor: false,\n          custom: \"\"\n        },\n        {\n          date: \"2016-05-03\",\n          name: \"王小虎\",\n          address: \"上海市普陀区金沙江路 1516 弄\",\n          isEditor: false,\n          custom: \"\"\n        }\n      ],\n      rightList: [],\n      addressDrag:{},\n      defaultProps: {\n        children: \"children\",\n        label: \"label\"\n      }\n    }\n  },\n  created() {\n    this.initTable()\n  },\n  methods: {\n    initTable(){\n      this.tableData.forEach(item => {\n        if (item.custom) {\n          item.custom = JSON.parse(item.custom);\n          console.log('---99',item.custom)\n          Object.keys(item.custom).forEach(key => {\n            if (this.propArr.indexOf(key) === -1) {\n              this.propArr.push(key);\n              this.dynamicColumns.push({prop: key, label: key});\n            }\n          })\n        } else {\n          item.custom = {};\n        }\n      })\n    },\n    edit(row, index) {\n      if(this.isUpdate){\n        row.isEditor = true;\n        this.addressDrag = {}\n        this.isUpdate = false\n      }\n    },\n    save(row, index) {\n      if(!this.isUpdate){\n        this.isUpdate = true\n        row.isEditor = false;\n        row.address = this.addressDrag.label\n      }\n    },\n    cancel(row, index) {\n      if(!this.isUpdate){\n        this.isUpdate = true\n        row.isEditor = false;\n      }\n    },\n    handleDragStart(node, ev) {\n      ev.dataTransfer.setData(\"item\", JSON.stringify(node.data));\n    },\n    allowDrop(draggingNode, dropNode, type) {\n      return false;\n    },\n    allowDrag(draggingNode) {\n      return true;\n    },\n    drop(event) {\n      let data = event.dataTransfer.getData(\"item\");\n      this.rightList.push(JSON.parse(data))\n      this.addressDrag = JSON.parse(data)\n        console.log('this.rightList:', this.rightList)\n    },\n    addColumn() {\n      this.$prompt(\"请输入列名\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\"\n      }).then(({ value }) => {\n        this.isEdit = true\n        this.dynamicColumns.push({\n          prop: value,\n          label: value\n        });\n      });\n    },\n    deleteColunm(index) {\n      this.dynamicColumns.splice(index, 1);\n    },\n    submit() {\n      let arr = [];\n      this.tableData.forEach(data => {\n        let temp = {};\n        temp.name = data.name;\n        let obj = {};\n        this.dynamicColumns.forEach(col => {\n          // 仅把有效的列提交\n          if (data.custom[col.prop]) {\n            obj[col.prop] = data.custom[col.prop];\n          }\n        });\n        if (JSON.stringify(obj) !== \"{}\") {\n          temp.custom = JSON.stringify(obj);\n        }\n        arr.push(temp);\n      });\n      this.isEdit = false\n      console.log('--this.tableData-',this.tableData)\n      console.log('--this.dynamicColumns-',this.dynamicColumns)\n    }\n  }\n}\n",null]}